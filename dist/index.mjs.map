{"version":3,"sources":["../src/pan.ts"],"sourcesContent":["// 1. Regex for PAN format\r\nexport const PAN_REGEX = /^[A-Z]{5}\\d{4}[A-Z]$/;\r\n\r\n// 2. Valid 4th characters (Entity types)\r\nexport const VALID_ENTITY_CHARS = \"PCHFATBLJG\";\r\n\r\n// 3. Regex for A-Z letter (reused for surname first letter)\r\nexport const LETTER_AZ_REGEX = /[A-Z]/;\r\n\r\n// 4. ONLY LETTERS REGEX\r\nexport const ONLY_LETTERS_REGEX = /^[A-Za-z]+$/;\r\n\r\n// 5. Result type\r\ntype PANValidationResult = {\r\n    valid: boolean;\r\n    error?: string;\r\n    message?: string;\r\n};\r\n\r\n/**\r\n * validatePAN â€“ KYC-grade PAN + Surname validation\r\n * @param pan - 10-char PAN\r\n * @param surname - User's surname (must match 5th char)\r\n */\r\nexport function validatePAN(pan: string, surname: string): PANValidationResult {\r\n    // 1. PAN: type + length\r\n    if (typeof pan !== \"string\" || pan.length !== 10) {\r\n        return {\r\n            valid: false,\r\n            error: \"PAN must be a 10-character string\"\r\n        };\r\n    }\r\n\r\n    const u = pan.toUpperCase();\r\n\r\n    // 2. Format\r\n    if (!PAN_REGEX.test(u)) {\r\n        return {\r\n            valid: false,\r\n            error: \"Invalid PAN format. Must be 5 letters + 4 digits + 1 letter\",\r\n        };\r\n    }\r\n\r\n    // 3. Entity type\r\n    const fourthChar = u[3];\r\n    if (!VALID_ENTITY_CHARS.includes(fourthChar)) {\r\n        return {\r\n            valid: false,\r\n            error: \"Invalid entity type (4th character)\"\r\n        };\r\n    }\r\n\r\n    // 4. Surname: type check FIRST\r\n    if (typeof surname !== \"string\") {\r\n        return {\r\n            valid: false,\r\n            error: \"Surname must be a string\"\r\n        };\r\n    }\r\n\r\n    // 5. Trim once\r\n    const trimmed = surname.trim();\r\n    if (trimmed.length === 0) {\r\n        return {\r\n            valid: false,\r\n            error: \"Surname cannot be empty\"\r\n        };\r\n    }\r\n\r\n    // 6. Only must letters\r\n    if (!ONLY_LETTERS_REGEX.test(trimmed)) {\r\n        return {\r\n            valid: false,\r\n            error: \"Surname must contain only letters (A-Z). No digits or symbols.\"\r\n        };\r\n    }\r\n\r\n    // 7. First surname letter\r\n    const firstSurnameLetter = trimmed.toUpperCase()[0];\r\n    if (!LETTER_AZ_REGEX.test(firstSurnameLetter)) {\r\n        return {\r\n            valid: false,\r\n            error: \"Surname must start with a letter (A-Z)\"\r\n        };\r\n    }\r\n\r\n    // 8. Match 5th char\r\n    const fifthChar = u[4];\r\n    if (fifthChar !== firstSurnameLetter) {\r\n        return {\r\n            valid: false,\r\n            error: `PAN 5th char '${fifthChar}' must match surname start '${firstSurnameLetter}'`,\r\n        };\r\n    }\r\n\r\n    return {\r\n        valid: true,\r\n        message: \"PAN is verified.\"\r\n    };\r\n}\r\n"],"mappings":"AACO,IAAMA,EAAY,uBAGZC,EAAqB,aAGrBC,EAAkB,QAGlBC,EAAqB,cAc3B,SAASC,EAAYC,EAAaC,EAAsC,CAE3E,GAAI,OAAOD,GAAQ,UAAYA,EAAI,SAAW,GAC1C,MAAO,CACH,MAAO,GACP,MAAO,mCACX,EAGJ,IAAME,EAAIF,EAAI,YAAY,EAG1B,GAAI,CAACL,EAAU,KAAKO,CAAC,EACjB,MAAO,CACH,MAAO,GACP,MAAO,6DACX,EAIJ,IAAMC,EAAaD,EAAE,CAAC,EACtB,GAAI,CAACN,EAAmB,SAASO,CAAU,EACvC,MAAO,CACH,MAAO,GACP,MAAO,qCACX,EAIJ,GAAI,OAAOF,GAAY,SACnB,MAAO,CACH,MAAO,GACP,MAAO,0BACX,EAIJ,IAAMG,EAAUH,EAAQ,KAAK,EAC7B,GAAIG,EAAQ,SAAW,EACnB,MAAO,CACH,MAAO,GACP,MAAO,yBACX,EAIJ,GAAI,CAACN,EAAmB,KAAKM,CAAO,EAChC,MAAO,CACH,MAAO,GACP,MAAO,gEACX,EAIJ,IAAMC,EAAqBD,EAAQ,YAAY,EAAE,CAAC,EAClD,GAAI,CAACP,EAAgB,KAAKQ,CAAkB,EACxC,MAAO,CACH,MAAO,GACP,MAAO,wCACX,EAIJ,IAAMC,EAAYJ,EAAE,CAAC,EACrB,OAAII,IAAcD,EACP,CACH,MAAO,GACP,MAAO,iBAAiBC,CAAS,+BAA+BD,CAAkB,GACtF,EAGG,CACH,MAAO,GACP,QAAS,kBACb,CACJ","names":["PAN_REGEX","VALID_ENTITY_CHARS","LETTER_AZ_REGEX","ONLY_LETTERS_REGEX","validatePAN","pan","surname","u","fourthChar","trimmed","firstSurnameLetter","fifthChar"]}